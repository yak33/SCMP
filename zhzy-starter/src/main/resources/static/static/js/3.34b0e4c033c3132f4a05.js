webpackJsonp([3],{"6pCH":function(e,t,a){"use strict";var o=a("bOdI"),n=a.n(o),r=a("Dd8w"),i=a.n(r),l=a("1LhG"),s=a("NYxO"),m=a("gyMJ"),c={computed:i()({},Object(s.d)({optionsDeptName:function(e){return e.common.keshi},mecidalType:function(e){return e.common.mecidalType},costType:function(e){return e.common.costType}})),data:function(){var e;return{pickerOptions0:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},formData:(e={deptName:"",deptCode:"",userName:"",emName:"",mecidalNum:"",isYuFu:0,emSex:1,weight:null,maker:sessionStorage.getItem("username"),makeDate:null,emComName:"",emAge:"",emMobile:""},n()(e,"weight",""),n()(e,"emAddress",""),e),rules:{emName:[{required:!0,message:"姓名不能为空",trigger:"blur"}],mecidalNum:[{required:!0,message:"就诊号不能为空",trigger:"blur"}],deptCode:[{required:!0,message:"就诊科室不能为空",trigger:"change"}],userCode:[{required:!0,message:"就诊医生不能为空",trigger:"change"}],isYuFu:[{required:!0,message:"",trigger:"change"}],mecidalType:[{required:!0,message:"就诊类别不能为空",trigger:"change"}],emNum:[{required:!0,message:"身份证号不能为空",trigger:"blur"},{validator:function(e,t,a){t&&(/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t)?a():a(new Error("身份证格式错误")))},trigger:"blur"}],emType:[{required:!0,message:"费用类别不能为空",trigger:"change"}],onSetDate:[{required:!0,message:"就诊时间不能为空",trigger:"change"}]},userListData:[],optionsYuFu:[{value:0,label:"否"},{value:1,label:"是",disabled:!0}],optionsSex:[{value:1,label:"男"},{value:0,label:"女"}]}},mounted:function(){},methods:{handelRegister:function(){var e=this;this.$refs.form.validate(function(t){t&&e.handelInsertData()})},handelInsertData:function(){var e=this;this.formData.makeDate||(this.formData.makeDate=Object(l.b)("yyyy-MM-dd hh:mm:ss",new Date)),Object(m._39)(this.formData).then(function(t){for(var a in e.$message.success("挂号成功"),e.formData)e.formData[a]="";e.formData.maker=sessionStorage.getItem("username"),e.formData.isYuFu=0,e.formData.emSex=1,e.$refs.form.resetFields()})},funSelectUser:function(){var e=this,t=this.userListData.find(function(t){return t.userCode==e.formData.userCode});this.formData.userName=t.userName},funCheckDept:function(){""==this.formData.deptCode&&this.$message.warning("请先选择就诊科室")},handelReset:function(){console.log("reset")},sexChange:function(e){0==e?this.optionsYuFu[1].disabled=!1:(this.formData.isYuFu=0,this.optionsYuFu[1].disabled=!0)},queryUserList:function(e,t){var a=this;""==this.formData.deptCode?(this.$message.warning("请先选择就诊科室"),t([])):Object(m._2)({deptCode:this.formData.deptCode}).then(function(e){var o=[];"1"==e.data.code?(a.$message.warning("科室没有医生"),t([])):(e.data.data.forEach(function(e){o.push({value:e.userName,id:e.userCode})}),t(o))})},handleSelect:function(e){this.formData.userCode=e.id},selectDept:function(e){var t=this;this.optionsDeptName.forEach(function(a){a.deptCode==e&&(t.formData.deptName=a.deptName)}),Object(m._2)({deptCode:this.formData.deptCode}).then(function(e){"0"==e.data.code?t.userListData=e.data.data:(t.$message.warning("科室没有医生"),t.userListData=[])})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form",attrs:{"label-width":"110px",model:e.formData,rules:e.rules}},[a("el-col",{staticClass:"huanzhe",attrs:{span:8}},[a("el-form-item",{attrs:{label:"挂号序号："}},[a("el-input",{attrs:{readonly:"",disabled:""},model:{value:e.formData.registrationNum,callback:function(t){e.$set(e.formData,"registrationNum",t)},expression:"formData.registrationNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"就诊科室：",prop:"deptCode"}},[a("el-select",{attrs:{placeholder:"请选择就诊科室"},on:{change:e.selectDept},model:{value:e.formData.deptCode,callback:function(t){e.$set(e.formData,"deptCode",t)},expression:"formData.deptCode"}},e._l(e.optionsDeptName,function(e){return a("el-option",{key:e.id,attrs:{label:e.deptName,value:e.deptCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"性别："}},[a("el-select",{attrs:{placeholder:"请选择性别"},on:{change:e.sexChange},model:{value:e.formData.emSex,callback:function(t){e.$set(e.formData,"emSex",t)},expression:"formData.emSex"}},e._l(e.optionsSex,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人："}},[a("el-input",{model:{value:e.formData.emComName,callback:function(t){e.$set(e.formData,"emComName",t)},expression:"formData.emComName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"费用类别：",prop:"emType"}},[a("el-select",{attrs:{placeholder:"请选择费用类别",size:"medium"},model:{value:e.formData.emType,callback:function(t){e.$set(e.formData,"emType",t)},expression:"formData.emType"}},e._l(e.costType,function(e){return a("el-option",{key:e.value,attrs:{label:e.mecidalTypeName,value:e.mecidalTypeCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"孕否：",prop:"isYuFu"}},[a("el-select",{attrs:{placeholder:"请选择孕否"},model:{value:e.formData.isYuFu,callback:function(t){e.$set(e.formData,"isYuFu",t)},expression:"formData.isYuFu"}},e._l(e.optionsYuFu,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})}))],1)],1),e._v(" "),a("el-col",{staticClass:"huanzhe",attrs:{span:8}},[a("el-form-item",{attrs:{label:"就诊号：",prop:"mecidalNum"}},[a("el-input",{model:{value:e.formData.mecidalNum,callback:function(t){e.$set(e.formData,"mecidalNum",t)},expression:"formData.mecidalNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"就诊医生：",prop:"userCode"}},[a("el-select",{attrs:{placeholder:"请先选择就诊科室"},on:{focus:e.funCheckDept,change:e.funSelectUser},model:{value:e.formData.userCode,callback:function(t){e.$set(e.formData,"userCode",t)},expression:"formData.userCode"}},e._l(e.userListData,function(e){return a("el-option",{key:e.userCode,attrs:{label:e.userName,value:e.userCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"年龄：",prop:"emAge"}},[a("el-input",{model:{value:e.formData.emAge,callback:function(t){e.$set(e.formData,"emAge",t)},expression:"formData.emAge"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话："}},[a("el-input",{model:{value:e.formData.emMobile,callback:function(t){e.$set(e.formData,"emMobile",t)},expression:"formData.emMobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"体重："}},[a("el-input",{model:{value:e.formData.weight,callback:function(t){e.$set(e.formData,"weight",t)},expression:"formData.weight"}}),e._v(" "),a("span",{staticClass:"input-fix"},[e._v("kg")])],1),e._v(" "),a("el-form-item",{attrs:{label:"添加人："}},[a("el-input",{model:{value:e.formData.maker,callback:function(t){e.$set(e.formData,"maker",t)},expression:"formData.maker"}})],1)],1),e._v(" "),a("el-col",{staticClass:"huanzhe",attrs:{span:8}},[a("el-form-item",{attrs:{label:"就诊时间：",prop:"onSetDate"}},[a("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions0,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.formData.onSetDate,callback:function(t){e.$set(e.formData,"onSetDate",t)},expression:"formData.onSetDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名：",prop:"emName"}},[a("el-input",{model:{value:e.formData.emName,callback:function(t){e.$set(e.formData,"emName",t)},expression:"formData.emName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"身份证号：",prop:"emNum"}},[a("el-input",{model:{value:e.formData.emNum,callback:function(t){e.$set(e.formData,"emNum",t)},expression:"formData.emNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"就诊类别：",prop:"mecidalType"}},[a("el-select",{attrs:{placeholder:"请选择就诊类别",size:"medium"},model:{value:e.formData.mecidalType,callback:function(t){e.$set(e.formData,"mecidalType",t)},expression:"formData.mecidalType"}},e._l(e.mecidalType,function(e){return a("el-option",{key:e.value,attrs:{label:e.mecidalTypeName,value:e.mecidalTypeCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"住址："}},[a("el-input",{model:{value:e.formData.emAddress,callback:function(t){e.$set(e.formData,"emAddress",t)},expression:"formData.emAddress"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"添加时间："}},[a("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions0,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间 [可选 会自动生成]"},model:{value:e.formData.makeDate,callback:function(t){e.$set(e.formData,"makeDate",t)},expression:"formData.makeDate"}})],1)],1)],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-top":"24px"},attrs:{span:24,align:"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handelRegister}},[e._v("挂 号")])],1)],1)},staticRenderFns:[]};var d=a("VU/8")(c,u,!1,function(e){a("obM4")},"data-v-3bd3c6d1",null);t.a=d.exports},fJtU:function(e,t){},"j/h1":function(e,t,a){"use strict";var o=a("woOf"),n=a.n(o),r=a("Dd8w"),i=a.n(r),l=a("gyMJ"),s=a("NYxO"),m={components:{"patient-info":a("luwd").a},props:{op:{default:!0},active:{type:String}},data:function(){return{tableData:[],total:0,infoVisible:!1,loading:!0,cuid:"",tableArgs:{searchText:"",sortName:"makeDate",sortOrder:"desc",pageSize:10,pageNumber:1,deptcode:"",treatmentState:0}}},methods:i()({},Object(s.c)("patient",["getPatientInfo","showpatientInfo"]),{getData:function(e){var t=this;this.loading=!0,(e=e||{}).index&&(this.tableArgs.pageNumber=e.index),n()(this.tableArgs,e),this.tableArgs.deptcode=sessionStorage.getItem("current_deptCode"),Object(l._20)(this.tableArgs).then(function(e){t.loading=!1,"0"==e.data.code?(t.total=e.data.data.total,t.tableData=e.data.data.content):(t.total=0,t.tableData=[])}).catch(function(e){t.loading=!1})},handlePageChange:function(e){this.tableArgs.pageNumber=e,this.getData()},openTreatment:function(e){sessionStorage.setItem("current_registrationNum",e.registrationNum),this.showpatientInfo();var t="/#/"+this.$route.path.split("/")[1]+"/treatment";this.getPatientInfo({id:e.registrationNum,cb:function(){window.location=t}})},openCaseInfo:function(e){sessionStorage.setItem("current_registrationNum",e.registrationNum),this.showpatientInfo();var t="/#/"+this.$route.path.split("/")[1]+"/case_info?id="+e.registrationNum+"&mn="+e.mecidalNum;this.getPatientInfo({id:e.registrationNum,cb:function(){window.location=t}})},openPatientInfo:function(e){var t=this;this.cuid=e,this.infoVisible=!0,this.$nextTick(function(){t.$refs.child.getData()})},handelCloseDialogInfo:function(){this.infoVisible=!1}})},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"table-top-searchbox"},[a("el-input",{attrs:{"suffix-icon":"el-icon-search",clearable:"",size:"small",placeholder:"输入您想要查询的病人姓名/就诊号/身份证号"},on:{blur:e.getData},nativeOn:{keydown:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getData(t):null}},model:{value:e.tableArgs.searchText,callback:function(t){e.$set(e.tableArgs,"searchText",t)},expression:"tableArgs.searchText"}})],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,fit:"",border:""}},[a("el-table-column",{attrs:{prop:"registrationNum","min-width":"120",label:"挂号序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mecidalNum","min-width":"110",label:"就诊号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"emName","min-width":"100",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"onSetDate","min-width":"160",label:"就诊日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName","min-width":"100",label:"开单医生"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deptName","min-width":"100",label:"开单科室"}}),e._v(" "),a("el-table-column",{attrs:{prop:"treatmentState","min-width":"70",label:"就诊状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"患者信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"link-blue",on:{click:function(a){e.openPatientInfo(t.row.registrationNum)}}},[e._v("患者信息")])]}}])}),e._v(" "),"not"==e.active?a("el-table-column",{attrs:{prop:"date",label:"重新就诊"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"link-blue",on:{click:function(a){e.openTreatment(t.row)}}},[e._v("重新就诊")])]}}])}):e._e(),e._v(" "),e.op?a("el-table-column",{attrs:{prop:"date",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["already"==e.active?a("span",{staticClass:"link-blue",on:{click:function(a){e.openTreatment(t.row)}}},[e._v("马上就诊")]):e._e(),e._v(" "),"not"==e.active?a("span",{staticClass:"link-blue",on:{click:function(a){e.openCaseInfo(t.row)}}},[e._v("查看病例")]):e._e()]}}])}):e._e()],1),e._v(" "),a("div",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.tableArgs.pageNumber,"page-size":e.tableArgs.pageSize,total:e.total},on:{"current-change":e.handlePageChange}})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.infoVisible,title:"患者信息",align:"center",width:"70%"},on:{"update:visible":function(t){e.infoVisible=t}}},[a("patient-info",{ref:"child",staticStyle:{padding:"0 12px"},attrs:{uid:e.cuid},on:{childClose:e.handelCloseDialogInfo}})],1)],1)},staticRenderFns:[]};var u=a("VU/8")(m,c,!1,function(e){a("sie/")},"data-v-68f14e58",null);t.a=u.exports},obM4:function(e,t){},"sie/":function(e,t){},u0Sk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("j/h1"),n=a("6pCH"),r={components:{"patient-list":o.a,"patient-info":n.a},data:function(){return{activeName:"already"}},methods:{handelTabChange:function(e){var t=0==e.index?0:1;this.$refs.patientList.getData({treatmentState:t,index:1}),sessionStorage.setItem("patient_list_active",e.name)}},mounted:function(){this.activeName=sessionStorage.getItem("patient_list_active")?sessionStorage.getItem("patient_list_active"):"already";var e="already"==this.activeName?0:1;this.$refs.patientList.getData({treatmentState:e})}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-tabs",{staticClass:"el-col el-col-24",attrs:{type:"card"},on:{"tab-click":e.handelTabChange},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未就诊",name:"already"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"已就诊",name:"not"}})],1),e._v(" "),a("div",{staticStyle:{position:"relative"}},[a("patient-list",{ref:"patientList",attrs:{active:e.activeName}})],1)],1)},staticRenderFns:[]};var l=a("VU/8")(r,i,!1,function(e){a("fJtU")},"data-v-3f76d006",null);t.default=l.exports}});
//# sourceMappingURL=3.34b0e4c033c3132f4a05.js.map
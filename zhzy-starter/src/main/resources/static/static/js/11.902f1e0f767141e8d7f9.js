webpackJsonp([11],{"N+nu":function(t,e){},gJ23:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),i=a.n(n),l=a("gyMJ"),o=a("NYxO"),s={computed:i()({},Object(o.d)({costType:function(t){return t.common.costType}}),{reallyPaySum:function(){var t=this,e=0;return!this.itemData.length>0?e=0:this.itemData.forEach(function(a){if("0"!=a.paystatus){var n=100,i=t.costType.find(function(t){return t.mecidalTypeCode==a.paytype});i&&(n=i.ratio),e+=parseFloat(100*a.totalmoney*n)}}),(Math.ceil(parseFloat(e/100))/100).toFixed(2)}}),watch:{itemData:function(t){if(t.length>0){var e=0;t.forEach(function(t){e+=parseFloat(t.totalmoney)}),this.sumTotalmoney=e}else this.sumTotalmoney=0}},data:function(){return{infoVisible:!1,empBasicMainID:"",tableData:[],itemData:[],total:0,paytype:"60",seletedItem:[],sumTotalmoney:0,loading:!0,getType:"",tableArgs:{searchText:"",sortName:"makeDate",sortOrder:"asc",pageSize:10,pageNumber:1}}},methods:{realPay:function(t){var e=100,a=this.costType.find(function(e){return e.mecidalTypeCode==t.paytype});a&&(e=parseFloat(a.ratio));var n=100*e*parseFloat(t.totalmoney)/1e4;return(Math.ceil(parseFloat(100*n))/100).toFixed(2)},getData:function(t,e){var a=this;this.loading=!0,this.tableArgs.pageNumber=e||this.tableArgs.pageNumber,void 0!==t&&(this.getType=t),Object(l._11)(i()({paystatus:this.getType},this.tableArgs)).then(function(t){a.loading=!1,"0"==t.data.code?(a.tableData=t.data.data.rows,a.total=t.data.data.total):(a.tableData=[],a.total=0)}).catch(function(t){a.loading=!1})},itemSelect:function(t){return!1},getItemList:function(){var t=this;Object(l._4)({empBasicMainID:this.empBasicMainID}).then(function(e){"0"==e.data.code&&(t.itemData=e.data.data,t.itemData.forEach(function(t){t.paytype=t.paytype.toString()}))})},funPayItem:function(t){var e=this;Object(l._68)({empBasicMainID:this.empBasicMainID,payitem:t.payitem,paytype:t.paytype,ratio:t.ratio}).then(function(a){"0"==a.data.code?(t.paystatus="1",e.$message.success("付款成功!")):e.$message.error("付款失败!")})},funPayAll:function(){},funPaytypeChange:function(t,e){var a=this.costType.find(function(e){return e.mecidalTypeCode==t});e.paytype=a.mecidalTypeCode,e.ratio=a.ratio},funPay:function(t){this.infoVisible=!0,this.empBasicMainID=t,this.getItemList()},handleSelectionChange:function(t){this.seletedItem=t},handlePageChange:function(t){this.tableArgs.pageNumber=t,this.getData()}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticStyle:{position:"relative"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData,fit:"",border:""}},[a("el-table-column",{attrs:{prop:"registrationNum","min-width":"120",label:"挂号序号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mecidalNum","min-width":"110",label:"就诊号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"emName","min-width":"100",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"makeDate","min-width":"160",label:"就诊日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userName","min-width":"100",label:"开单医生"}}),t._v(" "),a("el-table-column",{attrs:{prop:"paystatusstr","min-width":"70",label:"缴费状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-blue",on:{click:function(a){t.funPay(e.row.empbasicmainid)}}},[t._v("缴费")])]}}])})],1),t._v(" "),a("div",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":t.tableArgs.pageNumber,"page-size":t.tableArgs.pageSize,total:t.total},on:{"current-change":t.handlePageChange}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.infoVisible,title:"费用信息",align:"center",width:"70%"},on:{"update:visible":function(e){t.infoVisible=e}}},[a("el-row",[a("el-col",[a("el-table",{ref:"itemTable",attrs:{data:t.itemData},on:{"selection-change":t.handleSelectionChange,select:t.itemSelect}},[a("el-table-column",{attrs:{prop:"payitemstr","min-width":"110",align:"center",label:"项目"}}),t._v(" "),a("el-table-column",{attrs:{prop:"totalmoney","min-width":"110",align:"center",label:"费用金额"}}),t._v(" "),a("el-table-column",{attrs:{prop:"totalmoney","min-width":"110",align:"center",label:"费用类别"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"请选择",size:"medium"},on:{change:function(a){t.funPaytypeChange(a,e.row)}},model:{value:e.row.paytype,callback:function(a){t.$set(e.row,"paytype",a)},expression:"scope.row.paytype"}},t._l(t.costType,function(t){return a("el-option",{key:t.value,attrs:{label:t.mecidalTypeName,value:t.mecidalTypeCode}})}))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"totalmoney","min-width":"110",align:"center",formatter:t.realPay,label:"应付金额"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:"0"==e.row.paystatus,expression:"scope.row.paystatus == '0'"}],staticClass:"link-blue",on:{click:function(a){t.funPayItem(e.row)}}},[t._v("付款")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"1"==e.row.paystatus,expression:"scope.row.paystatus == '1'"}],staticClass:"link-blue"},[t._v("已付款")])]}}])})],1)],1),t._v(" "),a("el-col",{staticClass:"pay-bottom"},[a("span",[t._v("总费用: ￥"+t._s(t.sumTotalmoney))]),t._v(" "),a("span",[t._v("实付款: ￥"+t._s(t.reallyPaySum))])])],1)],1)],1)},staticRenderFns:[]};var c={components:{"finance-list":a("VU/8")(s,r,!1,function(t){a("N+nu")},"data-v-731f1b86",null).exports},data:function(){return{activeName:"list_noPay"}},methods:{handleClick:function(t){var e=0;"list_pay"==t.name&&(e=1),"can_pay"==t.name&&(e=2),this.funGetListData(e)},funGetListData:function(t){this.$refs.subList.getData(t,1)}},mounted:function(){this.funGetListData(0)}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未交费",name:"list_noPay"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已交费",name:"list_pay"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"部分交费",name:"can_pay"}}),t._v(" "),a("finance-list",{ref:"subList"})],1)],1)},staticRenderFns:[]};var p=a("VU/8")(c,u,!1,function(t){a("n0uh")},"data-v-7d0e0ea0",null);e.default=p.exports},n0uh:function(t,e){}});
//# sourceMappingURL=11.902f1e0f767141e8d7f9.js.map